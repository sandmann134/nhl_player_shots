/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Processing Utah Hockey Club at Toronto Maple Leafs, ID: 7d86671d89317cf2fc2ff0a7bbff8175
Player: Dylan Guenther
  Bookmaker: FanDuel, Over/Under: Over, Price: 1.85, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: FanDuel, Over/Under: Under, Price: 1.88, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.87, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Under, Price: 1.87, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.87, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.83, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.89, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 1.87, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
Player: Mitch Marner
  Bookmaker: FanDuel, Over/Under: Over, Price: 2.0, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: FanDuel, Over/Under: Under, Price: 1.77, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.95, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Under, Price: 1.8, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.91, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.8, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.97, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 1.8, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
Player: Nick Schmaltz
  Bookmaker: FanDuel, Over/Under: Over, Price: 1.51, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: FanDuel, Over/Under: Under, Price: 2.48, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.53, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Under, Price: 2.45, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.53, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Under, Price: 2.4, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.52, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 2.46, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
Player: Clayton Keller
  Bookmaker: FanDuel, Over/Under: Over, Price: 1.85, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: FanDuel, Over/Under: Under, Price: 1.91, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.87, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Under, Price: 1.87, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.83, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.87, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 1.89, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.87, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
Player: Mikhail Sergachev
  Bookmaker: FanDuel, Over/Under: Over, Price: 1.53, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: FanDuel, Over/Under: Under, Price: 2.42, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.57, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Under, Price: 2.35, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.54, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Under, Price: 2.3, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.55, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 2.38, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
Player: William Nylander
  Bookmaker: FanDuel, Over/Under: Over, Price: 1.62, Points: 3.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: FanDuel, Over/Under: Under, Price: 2.22, Points: 3.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.68, Points: 3.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Under, Price: 2.15, Points: 3.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.65, Points: 3.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Under, Price: 2.15, Points: 3.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.64, Points: 3.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 2.2, Points: 3.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
Player: Bobby McMann
  Bookmaker: FanDuel, Over/Under: Over, Price: 1.64, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: FanDuel, Over/Under: Under, Price: 2.2, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.68, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Under, Price: 2.15, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.67, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Under, Price: 2.1, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.66, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 2.17, Points: 2.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
Player: Morgan Rielly
  Bookmaker: FanDuel, Over/Under: Over, Price: 1.49, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: FanDuel, Over/Under: Under, Price: 2.54, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.51, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Under, Price: 2.5, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.5, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Under, Price: 2.45, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 2.51, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.5, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
Player: John Tavares
  Bookmaker: FanDuel, Over/Under: Over, Price: 2.16, Points: 3.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: FanDuel, Over/Under: Under, Price: 1.66, Points: 3.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Over, Price: 2.15, Points: 3.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Under, Price: 1.68, Points: 3.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Over, Price: 2.15, Points: 3.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.65, Points: 3.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 1.66, Points: 3.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 2.17, Points: 3.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
Player: Logan Cooley
  Bookmaker: FanDuel, Over/Under: Over, Price: 1.55, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: FanDuel, Over/Under: Under, Price: 2.38, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.57, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: DraftKings, Over/Under: Under, Price: 2.35, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.57, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetMGM, Over/Under: Under, Price: 2.3, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.56, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 2.37, Points: 1.5, Home Team: Toronto Maple Leafs, Away Team: Utah Hockey Club
Used requests: 166
Remaining requests: 334
/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Fetching and storing player data with weights: x_10 = 5, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled, model table: modelled_likelihoods
Found 50 players to model.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20222023.
Matvei Michkov has less than 60 GP.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20222023.
Matvei Michkov has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
No valid game log data available for player ID: 8482809 before date 2024-11-23 for season 20222023.
Jackson Blake has less than 60 GP.
No valid game log data available for player ID: 8482809 before date 2024-11-23 for season 20222023.
Jackson Blake has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-23 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-23 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20222023.
Maxim Tsyplakov has less than 60 GP.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20222023.
Maxim Tsyplakov has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8483431 before date 2024-11-24 for season 20222023.
No valid game log data available for player ID: 8483431 before date 2024-11-24 for season 20222023.
/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/weight_test.py:4: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd # type: ignore
/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Python interpreter: /Library/Developer/CommandLineTools/usr/bin/python3
Created table daily_ledger_scaled_weight3
Created table modelled_likelihoods_weight3
Fetching and storing player data with weights: x_10 = 3, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight3, model table: modelled_likelihoods_weight3
Found 50 players to model.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20222023.
Matvei Michkov has less than 60 GP.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20222023.
Matvei Michkov has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
No valid game log data available for player ID: 8482809 before date 2024-11-23 for season 20222023.
Jackson Blake has less than 60 GP.
No valid game log data available for player ID: 8482809 before date 2024-11-23 for season 20222023.
Jackson Blake has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-23 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-23 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20222023.
Maxim Tsyplakov has less than 60 GP.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20222023.
Maxim Tsyplakov has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8483431 before date 2024-11-24 for season 20222023.
No valid game log data available for player ID: 8483431 before date 2024-11-24 for season 20222023.
WARNING: Sum of suggested bets for date 2024-11-23 is greater than bankroll.
WARNING: Scaling all suggested bets for date 2024-11-23 by 0.40 to reduce bet volume below 100%.
Entire daily_ledger_scaled_weight3 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_weight3:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Created table daily_ledger_scaled_weight4
Created table modelled_likelihoods_weight4
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4, model table: modelled_likelihoods_weight4
Found 50 players to model.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20222023.
Matvei Michkov has less than 60 GP.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20222023.
Matvei Michkov has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
No valid game log data available for player ID: 8482809 before date 2024-11-23 for season 20222023.
Jackson Blake has less than 60 GP.
No valid game log data available for player ID: 8482809 before date 2024-11-23 for season 20222023.
Jackson Blake has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-23 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-23 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20222023.
Maxim Tsyplakov has less than 60 GP.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20222023.
Maxim Tsyplakov has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8483431 before date 2024-11-24 for season 20222023.
No valid game log data available for player ID: 8483431 before date 2024-11-24 for season 20222023.
WARNING: Sum of suggested bets for date 2024-11-23 is greater than bankroll.
WARNING: Scaling all suggested bets for date 2024-11-23 by 0.42 to reduce bet volume below 100%.
Entire daily_ledger_scaled_weight4 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_weight4:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
CSV file modelled_likelihoods_weight4_2024-11-24.csv created at /Users/alexmann/Documents/Code_Learning/nhl_fromscratch/daily_odds/modelled_likelihoods_weight4_2024-11-24.csv.
Created table daily_ledger_scaled
Created table modelled_likelihoods
Fetching and storing player data with weights: x_10 = 5, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled, model table: modelled_likelihoods
Found 0 players to model.
Entire daily_ledger_scaled table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/opposition_test.py:4: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd # type: ignore
/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Python interpreter: /Library/Developer/CommandLineTools/usr/bin/python3
Created table daily_ledger_scaled_weight4_twentiethOppositionFactor
Created table modelled_likelihoods_weight4_twentiethOppositionFactor
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4_wHalfOppositionFactor, model table: modelled_likelihoods_weight4_wHalfOppositionFactor
Found 50 players to model.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20222023.
Matvei Michkov has less than 60 GP.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20222023.
Matvei Michkov has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
No valid game log data available for player ID: 8482809 before date 2024-11-23 for season 20222023.
Jackson Blake has less than 60 GP.
No valid game log data available for player ID: 8482809 before date 2024-11-23 for season 20222023.
Jackson Blake has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-23 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-23 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20222023.
Maxim Tsyplakov has less than 60 GP.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20222023.
Maxim Tsyplakov has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8483431 before date 2024-11-24 for season 20222023.
No valid game log data available for player ID: 8483431 before date 2024-11-24 for season 20222023.
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4_tenthOppositionFactor, model table: modelled_likelihoods_weight4_tenthOppositionFactor
Found 50 players to model.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20222023.
Matvei Michkov has less than 60 GP.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20222023.
Matvei Michkov has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
No valid game log data available for player ID: 8482809 before date 2024-11-23 for season 20222023.
Jackson Blake has less than 60 GP.
No valid game log data available for player ID: 8482809 before date 2024-11-23 for season 20222023.
Jackson Blake has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-23 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-23 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20222023.
Maxim Tsyplakov has less than 60 GP.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20222023.
Maxim Tsyplakov has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8483431 before date 2024-11-24 for season 20222023.
No valid game log data available for player ID: 8483431 before date 2024-11-24 for season 20222023.
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4_twentiethOppositionFactor, model table: modelled_likelihoods_weight4_twentiethOppositionFactor
Found 50 players to model.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20222023.
Matvei Michkov has less than 60 GP.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20222023.
Matvei Michkov has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
No valid game log data available for player ID: 8482809 before date 2024-11-23 for season 20222023.
Jackson Blake has less than 60 GP.
No valid game log data available for player ID: 8482809 before date 2024-11-23 for season 20222023.
Jackson Blake has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-23 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-23 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20222023.
Maxim Tsyplakov has less than 60 GP.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20222023.
Maxim Tsyplakov has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8483431 before date 2024-11-24 for season 20222023.
No valid game log data available for player ID: 8483431 before date 2024-11-24 for season 20222023.
WARNING: Sum of suggested bets for date 2024-11-23 is greater than bankroll.
WARNING: Scaling all suggested bets for date 2024-11-23 by 0.38 to reduce bet volume below 100%.
WARNING: Sum of suggested bets for date 2024-11-23 is greater than bankroll.
WARNING: Scaling all suggested bets for date 2024-11-23 by 0.38 to reduce bet volume below 100%.
WARNING: Sum of suggested bets for date 2024-11-23 is greater than bankroll.
WARNING: Scaling all suggested bets for date 2024-11-23 by 0.38 to reduce bet volume below 100%.
CSV file modelled_likelihoods_weight4_tenthOppositionFactor_2024-11-24.csv created at /Users/alexmann/Documents/Code_Learning/nhl_fromscratch/daily_odds/modelled_likelihoods_weight4_tenthOppositionFactor_2024-11-24.csv.
Python interpreter: /Users/alexmann/.pyenv/versions/3.9.16/bin/python3
Fetching and storing player data with weights: x_10 = 5, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled, model table: modelled_likelihoods
Found 30 players to model.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20222023.
Matvei Michkov has less than 60 GP.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484387 before date 2024-11-23 for season 20222023.
Matvei Michkov has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
No valid game log data available for player ID: 8482809 before date 2024-11-23 for season 20222023.
Jackson Blake has less than 60 GP.
No valid game log data available for player ID: 8482809 before date 2024-11-23 for season 20222023.
Jackson Blake has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-23 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-23 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20222023.
Maxim Tsyplakov has less than 60 GP.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484958 before date 2024-11-23 for season 20222023.
Maxim Tsyplakov has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-23 for season 20222023.
Macklin Celebrini has less than 60 GP.
CSV file modelled_likelihoods_2024-11-24.csv created at /Users/alexmann/Documents/Code_Learning/nhl_fromscratch/daily_odds/modelled_likelihoods_2024-11-24.csv.
WARNING: Sum of suggested bets for date 2024-11-23 is greater than bankroll.
WARNING: Scaling all suggested bets for date 2024-11-23 by 0.44 to reduce bet volume below 100%.
Updated Ledger (daily_ledger_scaled_weight4):
[1, '2024-10-11', 24, '65.15', '100.00', '90.36']
[2, '2024-10-15', 45, '76.20', '90.36', '89.96']
[3, '2024-10-16', 22, '75.71', '89.96', '81.03']
[4, '2024-10-17', 45, '66.30', '81.03', '83.91']
[5, '2024-10-18', 24, '75.03', '83.91', '69.38']
[6, '2024-10-19', 45, '51.69', '69.38', '66.83']
[7, '2024-10-20', 5, '10.79', '66.83', '76.41']
[8, '2024-10-21', 7, '17.71', '76.41', '82.24']
[9, '2024-10-22', 39, '48.56', '82.24', '77.40']
[10, '2024-10-23', 6, '14.84', '77.40', '74.57']
[11, '2024-10-24', 37, '67.13', '74.57', '87.20']
[12, '2024-10-25', 18, '41.94', '87.20', '103.86']
[13, '2024-10-26', 45, '85.29', '103.86', '114.54']
[14, '2024-10-27', 29, '100.07', '114.54', '120.01']
[15, '2024-10-28', 39, '105.47', '120.01', '158.36']
[16, '2024-10-29', 26, '153.62', '158.36', '187.34']
[17, '2024-10-30', 45, '179.64', '187.34', '187.38']
[18, '2024-10-31', 39, '176.51', '187.38', '196.00']
[19, '2024-11-01', 40, '189.12', '196.00', '178.00']
[20, '2024-11-02', 42, '142.14', '178.00', '167.39']
[21, '2024-11-03', 24, '141.43', '167.39', '198.95']
[22, '2024-11-04', 12, '68.63', '198.95', '205.42']
[23, '2024-11-05', 44, '159.41', '205.42', '208.79']
[24, '2024-11-06', 19, '110.52', '208.79', '226.45']
[25, '2024-11-07', 45, '165.65', '226.45', '271.98']
[26, '2024-11-08', 21, '166.48', '271.98', '316.93']
[27, '2024-11-09', 44, '255.90', '316.93', '356.13']
[28, '2024-11-10', 23, '235.68', '356.13', '285.00']
[29, '2024-11-11', 23, '243.84', '285.00', '336.17']
[30, '2024-11-12', 36, '333.00', '336.17', '347.35']
[31, '2024-11-13', 30, '294.53', '347.35', '322.89']
[32, '2024-11-14', 42, '306.16', '322.89', '320.61']
[33, '2024-11-15', 25, '311.76', '320.61', '312.71']
[34, '2024-11-16', 45, '245.34', '312.71', '367.20']
[35, '2024-11-17', 29, '304.08', '367.20', '421.34']
[36, '2024-11-18', 35, '398.81', '421.34', '466.64']
[37, '2024-11-19', 26, '456.40', '466.64', '455.60']
[38, '2024-11-20', 32, '411.44', '455.60', '501.95']
[39, '2024-11-21', 43, '447.15', '501.95', '404.10']
[40, '2024-11-22', 8, '95.56', '404.10', '377.87']
[41, '2024-11-23', 42, '264.58', '377.87', '397.78']
Updated Ledger (daily_ledger_scaled_weight4_tenthOppositionFactor):
[1, '2024-10-11', 24, '65.23', '100.00', '90.33']
[2, '2024-10-15', 46, '76.61', '90.33', '90.71']
[3, '2024-10-16', 23, '76.77', '90.71', '82.84']
[4, '2024-10-17', 48, '70.10', '82.84', '86.08']
[5, '2024-10-18', 24, '74.66', '86.08', '71.21']
[6, '2024-10-19', 45, '52.93', '71.21', '68.37']
[7, '2024-10-20', 5, '11.01', '68.37', '78.47']
[8, '2024-10-21', 6, '17.14', '78.47', '84.90']
[9, '2024-10-22', 37, '48.63', '84.90', '76.10']
[10, '2024-10-23', 6, '14.50', '76.10', '73.25']
[11, '2024-10-24', 36, '64.12', '73.25', '86.27']
[12, '2024-10-25', 19, '42.34', '86.27', '101.65']
[13, '2024-10-26', 45, '84.61', '101.65', '114.68']
[14, '2024-10-27', 30, '95.42', '114.68', '119.23']
[15, '2024-10-28', 39, '105.41', '119.23', '109.93']
[16, '2024-10-29', 42, '101.31', '109.93', '133.39']
[17, '2024-10-30', 43, '128.94', '133.39', '136.66']
[18, '2024-10-31', 40, '129.26', '136.66', '141.58']
[19, '2024-11-01', 39, '132.80', '141.58', '129.92']
[20, '2024-11-02', 42, '104.15', '129.92', '123.79']
[21, '2024-11-03', 24, '103.10', '123.79', '146.35']
[22, '2024-11-04', 12, '47.38', '146.35', '148.23']
[23, '2024-11-05', 45, '120.19', '148.23', '169.80']
[24, '2024-11-06', 17, '85.81', '169.80', '188.13']
[25, '2024-11-07', 45, '129.50', '188.13', '211.63']
[26, '2024-11-08', 29, '180.04', '211.63', '262.46']
[27, '2024-11-09', 47, '209.37', '262.46', '290.83']
[28, '2024-11-10', 21, '181.29', '290.83', '235.44']
[29, '2024-11-11', 38, '231.14', '235.44', '259.07']
[30, '2024-11-12', 23, '216.74', '259.07', '322.87']
[31, '2024-11-13', 35, '322.87', '322.87', '388.74']
[32, '2024-11-14', 25, '330.80', '388.74', '407.24']
[33, '2024-11-15', 35, '400.85', '407.24', '468.56']
[34, '2024-11-16', 49, '404.61', '468.56', '527.06']
[35, '2024-11-17', 22, '338.63', '527.06', '528.55']
[36, '2024-11-18', 22, '494.09', '528.55', '536.42']
[37, '2024-11-19', 25, '515.73', '536.42', '523.85']
[38, '2024-11-20', 23, '378.44', '523.85', '736.39']
[39, '2024-11-21', 43, '626.65', '736.39', '717.22']
[40, '2024-11-22', 10, '206.39', '717.22', '675.39']
[41, '2024-11-23', 41, '455.28', '675.39', '635.01']
