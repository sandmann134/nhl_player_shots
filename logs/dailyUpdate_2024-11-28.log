/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Processing New York Rangers at Philadelphia Flyers, ID: 1403605c0466719bba35b56d45cc2c6d
Processing Chicago Blackhawks at Minnesota Wild, ID: 052b21a4a8933922bfa6b005df958687
Processing Vancouver Canucks at Buffalo Sabres, ID: 83725a377f291c8e612b5456c3e7ab31
Processing Calgary Flames at Columbus Blue Jackets, ID: 85bb7b27509359a93e1b3603f827f3e6
Processing Florida Panthers at Carolina Hurricanes, ID: 69ebce7a184f2d7d50a47ed89e46b4de
Processing New Jersey Devils at Detroit Red Wings, ID: 8f18127fff367e6a02e38c65e5fc8680
Processing Tampa Bay Lightning at Nashville Predators, ID: dde93e7aca35bb370fadaeb08fd01a23
Processing New York Islanders at Washington Capitals, ID: f23b6d525082aa6b146c345b16aaed12
Processing Los Angeles Kings at Anaheim Ducks, ID: bf004803414bb3fd39160c086931cf93
Processing Seattle Kraken at San Jose Sharks, ID: 3b1b21c5706969715d94b26632be2d9e
Processing Pittsburgh Penguins at Boston Bruins, ID: 40ac8331e5070d789b517a73279d46a8
Processing Winnipeg Jets at Vegas Golden Knights, ID: c76f2eddbd210adf55906792b0967e86
Processing Colorado Avalanche at Dallas Stars, ID: 8b7e72d8f3e8ab870125eca98a6722eb
Processing Edmonton Oilers at Utah Hockey Club, ID: 9fe413f068f04a04a491b268049cba0e
Used requests: 194
Remaining requests: 306
/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Traceback (most recent call last):
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/player_api.py", line 6, in <module>
    from tenacity import retry, stop_after_attempt, wait_exponential
ModuleNotFoundError: No module named 'tenacity'
/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/weight_test.py:4: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd # type: ignore
/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Traceback (most recent call last):
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/weight_test.py", line 7, in <module>
    from player_api import fetch_and_store_player_data
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/player_api.py", line 6, in <module>
    from tenacity import retry, stop_after_attempt, wait_exponential
ModuleNotFoundError: No module named 'tenacity'
/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/opposition_test.py:4: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd # type: ignore
/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Traceback (most recent call last):
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/opposition_test.py", line 7, in <module>
    from player_api import fetch_and_store_player_data
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/player_api.py", line 6, in <module>
    from tenacity import retry, stop_after_attempt, wait_exponential
ModuleNotFoundError: No module named 'tenacity'
Python interpreter: /Users/alexmann/.pyenv/versions/3.9.16/bin/python3
Fetching and storing player data with weights: x_10 = 5, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled, model table: modelled_likelihoods
Found 46 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Alex Nylander has less than 60 GP.
Alex Nylander has less than 60 GP.
No valid game log data available for player ID: 8484387 before date 2024-11-27 for season 20232024.
No valid game log data available for player ID: 8484387 before date 2024-11-27 for season 20222023.
Matvei Michkov has less than 60 GP.
No valid game log data available for player ID: 8484387 before date 2024-11-27 for season 20232024.
No valid game log data available for player ID: 8484387 before date 2024-11-27 for season 20222023.
Matvei Michkov has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-27 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-27 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-27 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-27 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-27 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-27 for season 20222023.
Olen Zellweger has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-27 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-27 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-27 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-27 for season 20222023.
Macklin Celebrini has less than 60 GP.
CSV file modelled_likelihoods_2024-11-28.csv created at /Users/alexmann/Documents/Code_Learning/nhl_fromscratch/daily_odds/modelled_likelihoods_2024-11-28.csv.
WARNING: Sum of suggested bets for date 2024-11-27 is greater than bankroll.
WARNING: Scaling all suggested bets for date 2024-11-27 by 0.43 to reduce bet volume below 100%.
No game found for player 8479318 on date 2024-11-27
Updated Ledger (daily_ledger_scaled_weight4):
[1, '2024-10-11', 24, '65.15', '100.00', '90.36']
[2, '2024-10-15', 45, '76.20', '90.36', '89.96']
[3, '2024-10-16', 22, '75.71', '89.96', '81.03']
[4, '2024-10-17', 45, '66.30', '81.03', '83.91']
[5, '2024-10-18', 24, '75.03', '83.91', '69.38']
[6, '2024-10-19', 45, '51.69', '69.38', '66.83']
[7, '2024-10-20', 5, '10.79', '66.83', '76.41']
[8, '2024-10-21', 7, '17.71', '76.41', '82.24']
[9, '2024-10-22', 39, '48.56', '82.24', '77.40']
[10, '2024-10-23', 6, '14.84', '77.40', '74.57']
[11, '2024-10-24', 37, '67.13', '74.57', '87.20']
[12, '2024-10-25', 18, '41.94', '87.20', '103.86']
[13, '2024-10-26', 45, '85.29', '103.86', '114.54']
[14, '2024-10-27', 29, '100.07', '114.54', '120.01']
[15, '2024-10-28', 39, '105.47', '120.01', '158.36']
[16, '2024-10-29', 26, '153.62', '158.36', '187.34']
[17, '2024-10-30', 45, '179.64', '187.34', '187.38']
[18, '2024-10-31', 39, '176.51', '187.38', '196.00']
[19, '2024-11-01', 40, '189.12', '196.00', '178.00']
[20, '2024-11-02', 42, '142.14', '178.00', '167.39']
[21, '2024-11-03', 24, '141.43', '167.39', '198.95']
[22, '2024-11-04', 12, '68.63', '198.95', '205.42']
[23, '2024-11-05', 44, '159.41', '205.42', '208.79']
[24, '2024-11-06', 19, '110.52', '208.79', '226.45']
[25, '2024-11-07', 45, '165.65', '226.45', '271.98']
[26, '2024-11-08', 21, '166.48', '271.98', '316.93']
[27, '2024-11-09', 44, '255.90', '316.93', '356.13']
[28, '2024-11-10', 23, '235.68', '356.13', '285.00']
[29, '2024-11-11', 23, '243.84', '285.00', '336.17']
[30, '2024-11-12', 36, '333.00', '336.17', '347.35']
[31, '2024-11-13', 30, '294.53', '347.35', '322.89']
[32, '2024-11-14', 42, '306.16', '322.89', '320.61']
[33, '2024-11-15', 25, '311.76', '320.61', '312.71']
[34, '2024-11-16', 45, '245.34', '312.71', '367.20']
[35, '2024-11-17', 29, '304.08', '367.20', '421.34']
[36, '2024-11-18', 35, '398.81', '421.34', '466.64']
[37, '2024-11-19', 26, '456.40', '466.64', '455.60']
[38, '2024-11-20', 32, '411.44', '455.60', '501.95']
[39, '2024-11-21', 43, '447.15', '501.95', '404.10']
[40, '2024-11-22', 8, '95.56', '404.10', '377.87']
[41, '2024-11-23', 42, '264.58', '377.87', '397.78']
[42, '2024-11-24', 4, '51.91', '397.78', '445.88']
[43, '2024-11-25', 43, '389.77', '445.88', '280.33']
[44, '2024-11-26', 13, '138.61', '280.33', '297.01']
Updated Ledger (daily_ledger_scaled_weight4_tenthOppositionFactor):
[1, '2024-10-11', 24, '65.23', '100.00', '90.33']
[2, '2024-10-15', 46, '76.61', '90.33', '90.71']
[3, '2024-10-16', 23, '76.77', '90.71', '82.84']
[4, '2024-10-17', 48, '70.10', '82.84', '86.08']
[5, '2024-10-18', 24, '74.66', '86.08', '71.21']
[6, '2024-10-19', 45, '52.93', '71.21', '68.37']
[7, '2024-10-20', 5, '11.01', '68.37', '78.47']
[8, '2024-10-21', 6, '17.14', '78.47', '84.90']
[9, '2024-10-22', 37, '48.63', '84.90', '76.10']
[10, '2024-10-23', 6, '14.50', '76.10', '73.25']
[11, '2024-10-24', 36, '64.12', '73.25', '86.27']
[12, '2024-10-25', 19, '42.34', '86.27', '101.65']
[13, '2024-10-26', 45, '84.61', '101.65', '114.68']
[14, '2024-10-27', 30, '95.42', '114.68', '119.23']
[15, '2024-10-28', 39, '105.41', '119.23', '109.93']
[16, '2024-10-29', 42, '101.31', '109.93', '133.39']
[17, '2024-10-30', 43, '128.94', '133.39', '136.66']
[18, '2024-10-31', 40, '129.26', '136.66', '141.58']
[19, '2024-11-01', 39, '132.80', '141.58', '129.92']
[20, '2024-11-02', 42, '104.15', '129.92', '123.79']
[21, '2024-11-03', 24, '103.10', '123.79', '146.35']
[22, '2024-11-04', 12, '47.38', '146.35', '148.23']
[23, '2024-11-05', 45, '120.19', '148.23', '169.80']
[24, '2024-11-06', 17, '85.81', '169.80', '188.13']
[25, '2024-11-07', 45, '129.50', '188.13', '211.63']
[26, '2024-11-08', 29, '180.04', '211.63', '262.46']
[27, '2024-11-09', 47, '209.37', '262.46', '290.83']
[28, '2024-11-10', 21, '181.29', '290.83', '235.44']
[29, '2024-11-11', 38, '231.14', '235.44', '259.07']
[30, '2024-11-12', 23, '216.74', '259.07', '322.87']
[31, '2024-11-13', 35, '322.87', '322.87', '388.74']
[32, '2024-11-14', 25, '330.80', '388.74', '407.24']
[33, '2024-11-15', 35, '400.85', '407.24', '468.56']
[34, '2024-11-16', 49, '404.61', '468.56', '527.06']
[35, '2024-11-17', 22, '338.63', '527.06', '528.55']
[36, '2024-11-18', 22, '494.09', '528.55', '536.42']
[37, '2024-11-19', 25, '515.73', '536.42', '523.85']
[38, '2024-11-20', 23, '378.44', '523.85', '736.39']
[39, '2024-11-21', 43, '626.65', '736.39', '717.22']
[40, '2024-11-22', 10, '206.39', '717.22', '675.39']
[41, '2024-11-23', 41, '455.28', '675.39', '635.01']
[42, '2024-11-24', 4, '81.52', '635.01', '714.39']
[43, '2024-11-25', 41, '577.21', '714.39', '546.21']
[44, '2024-11-26', 13, '258.76', '546.21', '578.84']
Traceback (most recent call last):
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/connection.py", line 199, in _new_conn
    sock = connection.create_connection(
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/socket.py", line 954, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/connectionpool.py", line 789, in urlopen
    response = self._make_request(
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/connectionpool.py", line 490, in _make_request
    raise new_e
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/connectionpool.py", line 466, in _make_request
    self._validate_conn(conn)
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/connectionpool.py", line 1095, in _validate_conn
    conn.connect()
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/connection.py", line 693, in connect
    self.sock = sock = self._new_conn()
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/connection.py", line 206, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPSConnection object at 0x10f80c640>: Failed to resolve 'api.the-odds-api.com' ([Errno 8] nodename nor servname provided, or not known)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/connectionpool.py", line 843, in urlopen
    retries = retries.increment(
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.the-odds-api.com', port=443): Max retries exceeded with url: /v4/sports/icehockey_nhl/events?api_key=204b8940e5d4c9be1a3ab2e8192a286f&regions=us&dateFormat=iso (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x10f80c640>: Failed to resolve 'api.the-odds-api.com' ([Errno 8] nodename nor servname provided, or not known)"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/odds_api_main.py", line 28, in <module>
    events_response = requests.get(
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/requests/adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.the-odds-api.com', port=443): Max retries exceeded with url: /v4/sports/icehockey_nhl/events?api_key=204b8940e5d4c9be1a3ab2e8192a286f&regions=us&dateFormat=iso (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x10f80c640>: Failed to resolve 'api.the-odds-api.com' ([Errno 8] nodename nor servname provided, or not known)"))
Fetching and storing player data with weights: x_10 = 5, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled, model table: modelled_likelihoods
Found 0 players to model.
Python interpreter: /Users/alexmann/.pyenv/versions/3.9.16/bin/python3
Traceback (most recent call last):
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/connection.py", line 199, in _new_conn
    sock = connection.create_connection(
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/socket.py", line 954, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/connectionpool.py", line 789, in urlopen
    response = self._make_request(
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/connectionpool.py", line 490, in _make_request
    raise new_e
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/connectionpool.py", line 466, in _make_request
    self._validate_conn(conn)
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/connectionpool.py", line 1095, in _validate_conn
    conn.connect()
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/connection.py", line 693, in connect
    self.sock = sock = self._new_conn()
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/connection.py", line 206, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPSConnection object at 0x1148d0cd0>: Failed to resolve 'api.nhle.com' ([Errno 8] nodename nor servname provided, or not known)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/connectionpool.py", line 843, in urlopen
    retries = retries.increment(
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.nhle.com', port=443): Max retries exceeded with url: /stats/rest/en/team/summary?sort=shotsForPerGame&cayenneExp=seasonId=20242025%20and%20gameTypeId=2 (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x1148d0cd0>: Failed to resolve 'api.nhle.com' ([Errno 8] nodename nor servname provided, or not known)"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/main.py", line 99, in <module>
    main()
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/main.py", line 58, in main
    daily_factor_update()
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/team_avg_SA.py", line 72, in daily_factor_update
    team_stats = get_team_stats()
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/team_avg_SA.py", line 11, in get_team_stats
    response = requests.get(team_shots_url)
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/Users/alexmann/.pyenv/versions/3.9.16/lib/python3.9/site-packages/requests/adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.nhle.com', port=443): Max retries exceeded with url: /stats/rest/en/team/summary?sort=shotsForPerGame&cayenneExp=seasonId=20242025%20and%20gameTypeId=2 (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x1148d0cd0>: Failed to resolve 'api.nhle.com' ([Errno 8] nodename nor servname provided, or not known)"))
