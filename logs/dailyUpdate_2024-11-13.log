/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Processing Detroit Red Wings at Pittsburgh Penguins, ID: dbee39176f0719f4d8c7b7bfc51811ea
Processing Toronto Maple Leafs at Washington Capitals, ID: 24af9bdf56f99e01051c02101c84850c
Processing Carolina Hurricanes at Utah Hockey Club, ID: e7c1b11993368096defb383e0307ad38
Processing Vegas Golden Knights at Anaheim Ducks, ID: 75046edfc166a64579c86ea3a2117387
Processing Los Angeles Kings at Colorado Avalanche, ID: 8cd75fceb07c4a4867d98cb7aa73dbd0
Player: Adrian Kempe
  Bookmaker: FanDuel, Over/Under: Over, Price: 2.34, Points: 3.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: FanDuel, Over/Under: Under, Price: 1.57, Points: 3.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.62, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Under, Price: 2.26, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.58, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 2.33, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.57, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Under, Price: 2.25, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
Player: Nathan MacKinnon
  Bookmaker: FanDuel, Over/Under: Over, Price: 2.12, Points: 4.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: FanDuel, Over/Under: Under, Price: 1.68, Points: 4.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Over, Price: 2.15, Points: 4.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Under, Price: 1.68, Points: 4.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 1.66, Points: 4.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 2.17, Points: 4.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Over, Price: 2.15, Points: 4.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.65, Points: 4.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
Player: Quinton Byfield
  Bookmaker: FanDuel, Over/Under: Over, Price: 1.61, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: FanDuel, Over/Under: Under, Price: 2.26, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.6, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Under, Price: 2.3, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.58, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 2.32, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.61, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Under, Price: 2.25, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
Player: Trevor Moore
  Bookmaker: FanDuel, Over/Under: Over, Price: 1.98, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: FanDuel, Over/Under: Under, Price: 1.78, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Over, Price: 2.05, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Under, Price: 1.74, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 2.07, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 1.72, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Over, Price: 2.05, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.69, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
Player: Mikko Rantanen
  Bookmaker: FanDuel, Over/Under: Over, Price: 2.18, Points: 3.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: FanDuel, Over/Under: Under, Price: 1.65, Points: 3.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Over, Price: 2.15, Points: 3.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Under, Price: 1.68, Points: 3.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 1.64, Points: 3.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 2.2, Points: 3.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Over, Price: 2.15, Points: 3.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.65, Points: 3.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
Player: Cale Makar
  Bookmaker: FanDuel, Over/Under: Over, Price: 2.4, Points: 3.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: FanDuel, Over/Under: Under, Price: 1.54, Points: 3.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Over, Price: 2.35, Points: 3.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Under, Price: 1.57, Points: 3.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 2.36, Points: 3.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 1.56, Points: 3.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Over, Price: 2.3, Points: 3.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.57, Points: 3.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
Player: Casey Mittelstadt
  Bookmaker: FanDuel, Over/Under: Over, Price: 1.64, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: FanDuel, Over/Under: Under, Price: 2.22, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.65, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Under, Price: 2.2, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 2.24, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.62, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.62, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Under, Price: 2.2, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
Player: Devon Toews
  Bookmaker: FanDuel, Over/Under: Over, Price: 1.78, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: FanDuel, Over/Under: Under, Price: 1.98, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.77, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Under, Price: 2.0, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.77, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 2.0, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.77, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.95, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
Player: Alex Laferriere
  Bookmaker: FanDuel, Over/Under: Over, Price: 2.3, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: FanDuel, Over/Under: Under, Price: 1.59, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Over, Price: 2.3, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Under, Price: 1.6, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 1.57, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 2.34, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Over, Price: 2.25, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.57, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
Player: Kevin Fiala
  Bookmaker: FanDuel, Over/Under: Over, Price: 1.8, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: FanDuel, Over/Under: Under, Price: 1.96, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.77, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Under, Price: 2.0, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.76, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 2.02, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.74, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Under, Price: 2.0, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
Player: Artturi Lehkonen
  Bookmaker: FanDuel, Over/Under: Over, Price: 1.78, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: FanDuel, Over/Under: Under, Price: 1.98, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.91, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Under, Price: 1.83, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.95, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 1.81, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.91, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.8, Points: 2.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
Player: Warren Foegele
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.65, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: DraftKings, Over/Under: Under, Price: 2.2, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.63, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 2.22, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.65, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
  Bookmaker: BetMGM, Over/Under: Under, Price: 2.15, Points: 1.5, Home Team: Colorado Avalanche, Away Team: Los Angeles Kings
Used requests: 89
Remaining requests: 411
/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Fetching and storing player data with weights: x_10 = 5, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled, model table: modelled_likelihoods
Found 148 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/weight_test.py:4: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd # type: ignore
/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Python interpreter: /Library/Developer/CommandLineTools/usr/bin/python3
Created table daily_ledger_scaled_weight3
Created table modelled_likelihoods_weight3
Fetching and storing player data with weights: x_10 = 3, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight3, model table: modelled_likelihoods_weight3
Found 148 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
WARNING: Sum of suggested bets for date 2024-11-12 is greater than bankroll.
WARNING: Only using 2024-11-12 suggested bets > 2% of bankroll to reduce bet volume below 100%.
Entire daily_ledger_scaled_weight3 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_weight3:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Created table daily_ledger_scaled_weight4
Created table modelled_likelihoods_weight4
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4, model table: modelled_likelihoods_weight4
Found 148 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
No game found for player 8477935 on date 2024-11-12
Entire daily_ledger_scaled_weight4 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_weight4:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
CSV file modelled_likelihoods_weight4_2024-11-13.csv created at /Users/alexmann/Documents/Code_Learning/nhl_fromscratch/daily_odds/modelled_likelihoods_weight4_2024-11-13.csv.
Created table daily_ledger_scaled
Created table modelled_likelihoods
Fetching and storing player data with weights: x_10 = 5, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled, model table: modelled_likelihoods
Found 14 players to model.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
Entire daily_ledger_scaled table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Created table daily_ledger_scaled_weight6
Created table modelled_likelihoods_weight6
Fetching and storing player data with weights: x_10 = 6, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight6, model table: modelled_likelihoods_weight6
Found 148 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
No game found for player 8477935 on date 2024-11-12
Entire daily_ledger_scaled_weight6 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_weight6:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/opposition_test.py:4: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd # type: ignore
/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Python interpreter: /Library/Developer/CommandLineTools/usr/bin/python3
Created table daily_ledger_scaled_weight4_tenthOppositionFactor
Created table modelled_likelihoods_weight4_tenthOppositionFactor
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4_wQuarterOppositionFactor, model table: modelled_likelihoods_weight4_wQuarterOppositionFactor
Found 148 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4_wHalfOppositionFactor, model table: modelled_likelihoods_weight4_wHalfOppositionFactor
Found 148 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4_wOppositionFactor, model table: modelled_likelihoods_weight4_wOppositionFactor
Found 148 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4_tenthOppositionFactor, model table: modelled_likelihoods_weight4_tenthOppositionFactor
Found 148 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
WARNING: Sum of suggested bets for date 2024-11-12 is greater than bankroll.
WARNING: Only using 2024-11-12 suggested bets > 2% of bankroll to reduce bet volume below 100%.
WARNING: Sum of suggested bets for date 2024-11-12 is greater than bankroll.
WARNING: Only using 2024-11-12 suggested bets > 2% of bankroll to reduce bet volume below 100%.
WARNING: Sum of suggested bets for date 2024-11-12 is greater than bankroll.
WARNING: Only using 2024-11-12 suggested bets > 2% of bankroll to reduce bet volume below 100%.
WARNING: Sum of suggested bets for date 2024-11-12 is greater than bankroll.
WARNING: Only using 2024-11-12 suggested bets > 2% of bankroll to reduce bet volume below 100%.
CSV file modelled_likelihoods_weight4_tenthOppositionFactor_2024-11-13.csv created at /Users/alexmann/Documents/Code_Learning/nhl_fromscratch/daily_odds/modelled_likelihoods_weight4_tenthOppositionFactor_2024-11-13.csv.
/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/weight_test3_avg.py:4: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd # type: ignore
/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Python interpreter: /Library/Developer/CommandLineTools/usr/bin/python3
Created table daily_ledger_scaled_2324flat
Created table modelled_likelihoods_2324flat
Created table daily_ledger_scaled_2324flat_x10_3
Created table modelled_likelihoods_2324flat_x10_3
Created table daily_ledger_scaled_222324flat_x10_3
Created table modelled_likelihoods_222324flat_x10_3
Fetching and storing player data with weights: x_10 = 1, x_2024 = 1, x_2023 = 1, x_2022 = 0
Using ledger: daily_ledger_scaled_2324flat, model table: modelled_likelihoods_2324flat
Found 148 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
Fetching and storing player data with weights: x_10 = 3, x_2024 = 1, x_2023 = 1, x_2022 = 0
Using ledger: daily_ledger_scaled_2324flat_x10_3, model table: modelled_likelihoods_2324flat_x10_3
Found 148 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
Fetching and storing player data with weights: x_10 = 3, x_2024 = 1, x_2023 = 1, x_2022 = 1
Using ledger: daily_ledger_scaled_222324flat_x10_3, model table: modelled_likelihoods_222324flat_x10_3
Found 148 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483431 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
No valid game log data available for player ID: 8482155 before date 2024-11-13 for season 20222023.
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4, model table: modelled_likelihoods_weight4
Found 14 players to model.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
WARNING: Sum of suggested bets for date 2024-11-12 is greater than bankroll.
WARNING: Scaling all suggested bets for date 2024-11-12 by 0.78 to reduce bet volume below 100%.
No game found for player 8477935 on date 2024-11-12
Entire daily_ledger_scaled_2324flat table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_2324flat:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Entire daily_ledger_scaled_2324flat_x10_3 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_2324flat_x10_3:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Entire daily_ledger_scaled_222324flat_x10_3 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_222324flat_x10_3:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Entire daily_ledger_scaled_weight3 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_weight3:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Entire daily_ledger_scaled_weight4 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_weight4:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Python interpreter: /Users/alexmann/.pyenv/versions/3.9.16/bin/python3
Fetching and storing player data with weights: x_10 = 5, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled, model table: modelled_likelihoods
Found 18 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-13 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-13 for season 20222023.
Olen Zellweger has less than 60 GP.
CSV file modelled_likelihoods_2024-11-13.csv created at /Users/alexmann/Documents/Code_Learning/nhl_fromscratch/daily_odds/modelled_likelihoods_2024-11-13.csv.
No game found for player 8477935 on date 2024-11-12
Updated Ledger (daily_ledger_scaled):
[1, '2024-10-11', 27, '91.06', '100.00', '89.48']
[2, '2024-10-15', 46, '75.72', '89.48', '89.68']
[3, '2024-10-16', 24, '88.09', '89.68', '77.24']
[4, '2024-10-17', 45, '62.52', '77.24', '80.25']
[5, '2024-10-18', 27, '79.52', '80.25', '64.91']
[6, '2024-10-19', 43, '45.81', '64.91', '64.25']
[7, '2024-10-20', 5, '13.11', '64.25', '75.91']
[8, '2024-10-21', 7, '22.30', '75.91', '84.02']
[9, '2024-10-22', 39, '48.96', '84.02', '78.99']
[10, '2024-10-23', 7, '20.05', '78.99', '76.37']
[11, '2024-10-24', 36, '68.50', '76.37', '88.73']
[12, '2024-10-25', 18, '40.38', '88.73', '105.04']
[13, '2024-10-26', 46, '87.79', '105.04', '113.67']
[14, '2024-10-27', 30, '98.46', '113.67', '120.33']
[15, '2024-10-28', 39, '105.53', '120.33', '114.69']
[16, '2024-10-29', 26, '107.34', '114.69', '135.76']
[17, '2024-10-30', 43, '127.44', '135.76', '137.08']
[18, '2024-10-31', 39, '129.14', '137.08', '143.85']
[19, '2024-11-01', 28, '141.94', '143.85', '127.53']
[20, '2024-11-02', 41, '101.88', '127.53', '123.89']
[21, '2024-11-03', 22, '96.50', '123.89', '132.95']
[22, '2024-11-04', 12, '44.97', '132.95', '137.24']
[23, '2024-11-05', 43, '106.32', '137.24', '140.51']
[24, '2024-11-06', 19, '70.47', '140.51', '153.43']
[25, '2024-11-07', 44, '113.95', '153.43', '182.61']
[26, '2024-11-08', 19, '105.57', '182.61', '211.74']
[27, '2024-11-09', 42, '169.92', '211.74', '238.58']
[28, '2024-11-10', 23, '153.48', '238.58', '188.80']
[29, '2024-11-11', 22, '156.03', '188.80', '223.47']
[30, '2024-11-12', 36, '211.54', '223.47', '233.25']
Updated Ledger (daily_ledger_scaled_weight4):
[1, '2024-10-11', 24, '65.15', '100.00', '90.36']
[2, '2024-10-15', 45, '76.20', '90.36', '89.96']
[3, '2024-10-16', 22, '75.71', '89.96', '81.03']
[4, '2024-10-17', 45, '66.30', '81.03', '83.91']
[5, '2024-10-18', 24, '75.03', '83.91', '69.38']
[6, '2024-10-19', 45, '51.69', '69.38', '66.83']
[7, '2024-10-20', 5, '10.79', '66.83', '76.41']
[8, '2024-10-21', 7, '17.71', '76.41', '82.24']
[9, '2024-10-22', 39, '48.56', '82.24', '77.40']
[10, '2024-10-23', 6, '14.84', '77.40', '74.57']
[11, '2024-10-24', 37, '67.13', '74.57', '87.20']
[12, '2024-10-25', 18, '41.94', '87.20', '103.86']
[13, '2024-10-26', 45, '85.29', '103.86', '114.54']
[14, '2024-10-27', 29, '100.07', '114.54', '120.01']
[15, '2024-10-28', 39, '105.47', '120.01', '158.36']
[16, '2024-10-29', 26, '153.62', '158.36', '187.34']
[17, '2024-10-30', 45, '179.64', '187.34', '187.38']
[18, '2024-10-31', 39, '176.51', '187.38', '196.00']
[19, '2024-11-01', 40, '189.12', '196.00', '178.00']
[20, '2024-11-02', 42, '142.14', '178.00', '167.39']
[21, '2024-11-03', 24, '141.43', '167.39', '198.95']
[22, '2024-11-04', 12, '68.63', '198.95', '205.42']
[23, '2024-11-05', 44, '159.41', '205.42', '208.79']
[24, '2024-11-06', 19, '110.52', '208.79', '226.45']
[25, '2024-11-07', 45, '165.65', '226.45', '271.98']
[26, '2024-11-08', 21, '166.48', '271.98', '316.93']
[27, '2024-11-09', 44, '255.90', '316.93', '356.13']
[28, '2024-11-10', 23, '235.68', '356.13', '285.00']
[29, '2024-11-11', 23, '243.84', '285.00', '336.17']
[30, '2024-11-12', 36, '333.00', '336.17', '347.35']
