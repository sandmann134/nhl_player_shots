/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Processing Winnipeg Jets at New York Rangers, ID: 38be52a68c3d7a6c5c2f9d4529f39f05
Processing Ottawa Senators at Toronto Maple Leafs, ID: 2014811a18aa3bb9a58fd5720a6a5ceb
Processing New Jersey Devils at Florida Panthers, ID: 8938215ebe3cce2fc0ef002e6a58efc5
Processing Boston Bruins at St Louis Blues, ID: c153792d3457562122fba5c3b99a645c
Processing New York Islanders at Edmonton Oilers, ID: aad153ec0b41536e00a9c64cbc509c2b
Processing Calgary Flames at Vancouver Canucks, ID: c083803811051dbc47aaa4c192125cd1
Processing Columbus Blue Jackets at Seattle Kraken, ID: 2e52ca67c761d85ec534e983e9d5f92b
Player: Adam Fantilli
  Bookmaker: DraftKings, Over/Under: Over, Price: 2.15, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: DraftKings, Over/Under: Under, Price: 1.68, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 2.15, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 1.67, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Over, Price: 2.1, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.65, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
Player: Brandon Montour
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.62, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: DraftKings, Over/Under: Under, Price: 2.26, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.6, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 2.27, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.61, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Under, Price: 2.2, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
Player: Cole Sillinger
  Bookmaker: DraftKings, Over/Under: Over, Price: 2.35, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: DraftKings, Over/Under: Under, Price: 1.57, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 1.56, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 2.36, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Over, Price: 2.3, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.57, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
Player: Dmitri Voronkov
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.74, Points: 1.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: DraftKings, Over/Under: Under, Price: 2.05, Points: 1.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.72, Points: 1.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 2.07, Points: 1.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.71, Points: 1.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Under, Price: 2.05, Points: 1.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
Player: Jaden Schwartz
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.62, Points: 1.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: DraftKings, Over/Under: Under, Price: 2.26, Points: 1.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 2.29, Points: 1.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.59, Points: 1.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.61, Points: 1.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Under, Price: 2.25, Points: 1.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
Player: Jared McCann
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.6, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: DraftKings, Over/Under: Under, Price: 2.3, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.58, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 2.31, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.57, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Under, Price: 2.25, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
Player: Jordan Eberle
  Bookmaker: DraftKings, Over/Under: Over, Price: 2.35, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: DraftKings, Over/Under: Under, Price: 1.57, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 1.56, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 2.36, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Over, Price: 2.3, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.54, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
Player: Kirill Marchenko
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.91, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: DraftKings, Over/Under: Under, Price: 1.83, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 1.84, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.92, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.91, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.83, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
Player: Matty Beniers
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.68, Points: 1.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: DraftKings, Over/Under: Under, Price: 2.15, Points: 1.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 2.16, Points: 1.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.66, Points: 1.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.67, Points: 1.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Under, Price: 2.1, Points: 1.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
Player: Oliver Bjorkstrand
  Bookmaker: DraftKings, Over/Under: Over, Price: 2.45, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: DraftKings, Over/Under: Under, Price: 1.53, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 1.52, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 2.46, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Over, Price: 2.4, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.53, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
Player: Sean Monahan
  Bookmaker: DraftKings, Over/Under: Over, Price: 2.3, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: DraftKings, Over/Under: Under, Price: 1.6, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 2.3, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 1.59, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Over, Price: 2.25, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.57, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
Player: Yegor Chinakhov
  Bookmaker: DraftKings, Over/Under: Over, Price: 1.87, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: DraftKings, Over/Under: Under, Price: 1.87, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 1.87, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 1.89, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Over, Price: 1.87, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.83, Points: 2.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
Player: Zach Werenski
  Bookmaker: DraftKings, Over/Under: Over, Price: 2.15, Points: 3.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: DraftKings, Over/Under: Under, Price: 1.68, Points: 3.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Over, Price: 2.15, Points: 3.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetOnline.ag, Over/Under: Under, Price: 1.67, Points: 3.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Over, Price: 2.05, Points: 3.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
  Bookmaker: BetMGM, Over/Under: Under, Price: 1.69, Points: 3.5, Home Team: Seattle Kraken, Away Team: Columbus Blue Jackets
Used requests: 84
Remaining requests: 416
/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Fetching and storing player data with weights: x_10 = 5, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled, model table: modelled_likelihoods
Found 206 players to model.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/weight_test.py:4: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd # type: ignore
/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Python interpreter: /Library/Developer/CommandLineTools/usr/bin/python3
Created table daily_ledger_scaled_weight3
Created table modelled_likelihoods_weight3
Fetching and storing player data with weights: x_10 = 3, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight3, model table: modelled_likelihoods_weight3
Found 206 players to model.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
WARNING: Sum of suggested bets for date 2024-11-11 is greater than bankroll.
WARNING: Only using 2024-11-11 suggested bets > 2% of bankroll to reduce bet volume below 100%.
Entire daily_ledger_scaled_weight3 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_weight3:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Created table daily_ledger_scaled_weight4
Created table modelled_likelihoods_weight4
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4, model table: modelled_likelihoods_weight4
Found 206 players to model.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
WARNING: Sum of suggested bets for date 2024-11-11 is greater than bankroll.
WARNING: Only using 2024-11-11 suggested bets > 2% of bankroll to reduce bet volume below 100%.
Entire daily_ledger_scaled_weight4 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_weight4:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
CSV file modelled_likelihoods_weight4_2024-11-12.csv created at /Users/alexmann/Documents/Code_Learning/nhl_fromscratch/daily_odds/modelled_likelihoods_weight4_2024-11-12.csv.
Created table daily_ledger_scaled
Created table modelled_likelihoods
Fetching and storing player data with weights: x_10 = 5, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled, model table: modelled_likelihoods
Found 4 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Entire daily_ledger_scaled table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Created table daily_ledger_scaled_weight6
Created table modelled_likelihoods_weight6
Fetching and storing player data with weights: x_10 = 6, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight6, model table: modelled_likelihoods_weight6
Found 206 players to model.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
WARNING: Sum of suggested bets for date 2024-11-11 is greater than bankroll.
WARNING: Only using 2024-11-11 suggested bets > 2% of bankroll to reduce bet volume below 100%.
Entire daily_ledger_scaled_weight6 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_weight6:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/opposition_test.py:4: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd # type: ignore
/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Python interpreter: /Library/Developer/CommandLineTools/usr/bin/python3
Created table daily_ledger_scaled_weight4_tenthOppositionFactor
Created table modelled_likelihoods_weight4_tenthOppositionFactor
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4_wQuarterOppositionFactor, model table: modelled_likelihoods_weight4_wQuarterOppositionFactor
Found 206 players to model.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4_wHalfOppositionFactor, model table: modelled_likelihoods_weight4_wHalfOppositionFactor
Found 206 players to model.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4_wOppositionFactor, model table: modelled_likelihoods_weight4_wOppositionFactor
Found 206 players to model.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4_tenthOppositionFactor, model table: modelled_likelihoods_weight4_tenthOppositionFactor
Found 206 players to model.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
WARNING: Sum of suggested bets for date 2024-11-11 is greater than bankroll.
WARNING: Scaling all suggested bets for date 2024-11-11 by 0.83 to reduce bet volume below 100%.
No game found for player 8480028 on date 2024-11-11
No game found for player 8482093 on date 2024-11-11
WARNING: Sum of suggested bets for date 2024-11-11 is greater than bankroll.
WARNING: Scaling all suggested bets for date 2024-11-11 by 0.83 to reduce bet volume below 100%.
No game found for player 8480028 on date 2024-11-11
No game found for player 8482093 on date 2024-11-11
WARNING: Sum of suggested bets for date 2024-11-11 is greater than bankroll.
WARNING: Scaling all suggested bets for date 2024-11-11 by 0.83 to reduce bet volume below 100%.
No game found for player 8480028 on date 2024-11-11
No game found for player 8482093 on date 2024-11-11
WARNING: Sum of suggested bets for date 2024-11-11 is greater than bankroll.
WARNING: Scaling all suggested bets for date 2024-11-11 by 0.83 to reduce bet volume below 100%.
No game found for player 8480028 on date 2024-11-11
No game found for player 8482093 on date 2024-11-11
CSV file modelled_likelihoods_weight4_tenthOppositionFactor_2024-11-12.csv created at /Users/alexmann/Documents/Code_Learning/nhl_fromscratch/daily_odds/modelled_likelihoods_weight4_tenthOppositionFactor_2024-11-12.csv.
/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/weight_test3_avg.py:4: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd # type: ignore
/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Python interpreter: /Library/Developer/CommandLineTools/usr/bin/python3
Created table daily_ledger_scaled_2324flat
Created table modelled_likelihoods_2324flat
Created table daily_ledger_scaled_2324flat_x10_3
Created table modelled_likelihoods_2324flat_x10_3
Created table daily_ledger_scaled_222324flat_x10_3
Created table modelled_likelihoods_222324flat_x10_3
Fetching and storing player data with weights: x_10 = 1, x_2024 = 1, x_2023 = 1, x_2022 = 0
Using ledger: daily_ledger_scaled_2324flat, model table: modelled_likelihoods_2324flat
Found 206 players to model.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
Fetching and storing player data with weights: x_10 = 3, x_2024 = 1, x_2023 = 1, x_2022 = 0
Using ledger: daily_ledger_scaled_2324flat_x10_3, model table: modelled_likelihoods_2324flat_x10_3
Found 206 players to model.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
Fetching and storing player data with weights: x_10 = 3, x_2024 = 1, x_2023 = 1, x_2022 = 1
Using ledger: daily_ledger_scaled_222324flat_x10_3, model table: modelled_likelihoods_222324flat_x10_3
Found 206 players to model.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-12 for season 20222023.
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4, model table: modelled_likelihoods_weight4
Found 4 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
WARNING: Sum of suggested bets for date 2024-11-11 is greater than bankroll.
WARNING: Only using 2024-11-11 suggested bets > 2% of bankroll to reduce bet volume below 100%.
No game found for player 8482093 on date 2024-11-11
WARNING: Sum of suggested bets for date 2024-11-11 is greater than bankroll.
WARNING: Scaling all suggested bets for date 2024-11-11 by 0.82 to reduce bet volume below 100%.
Entire daily_ledger_scaled_2324flat table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_2324flat:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Entire daily_ledger_scaled_2324flat_x10_3 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_2324flat_x10_3:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Entire daily_ledger_scaled_222324flat_x10_3 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_222324flat_x10_3:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Entire daily_ledger_scaled_weight3 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_weight3:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Entire daily_ledger_scaled_weight4 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_weight4:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Python interpreter: /Users/alexmann/.pyenv/versions/3.9.16/bin/python3
Fetching and storing player data with weights: x_10 = 5, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled, model table: modelled_likelihoods
Found 22 players to model.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-11 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-11 for season 20222023.
Macklin Celebrini has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Brandt Clarke has less than 60 GP.
Brandt Clarke has less than 60 GP.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
CSV file modelled_likelihoods_2024-11-12.csv created at /Users/alexmann/Documents/Code_Learning/nhl_fromscratch/daily_odds/modelled_likelihoods_2024-11-12.csv.
WARNING: Sum of suggested bets for date 2024-11-11 is greater than bankroll.
WARNING: Only using 2024-11-11 suggested bets > 2% of bankroll to reduce bet volume below 100%.
Updated Ledger (daily_ledger_scaled):
[1, '2024-10-11', 27, '91.06', '100.00', '89.48']
[2, '2024-10-15', 46, '75.72', '89.48', '89.68']
[3, '2024-10-16', 24, '88.09', '89.68', '77.24']
[4, '2024-10-17', 45, '62.52', '77.24', '80.25']
[5, '2024-10-18', 27, '79.52', '80.25', '64.91']
[6, '2024-10-19', 43, '45.81', '64.91', '64.25']
[7, '2024-10-20', 5, '13.11', '64.25', '75.91']
[8, '2024-10-21', 7, '22.30', '75.91', '84.02']
[9, '2024-10-22', 39, '48.96', '84.02', '78.99']
[10, '2024-10-23', 7, '20.05', '78.99', '76.37']
[11, '2024-10-24', 36, '68.50', '76.37', '88.73']
[12, '2024-10-25', 18, '40.38', '88.73', '105.04']
[13, '2024-10-26', 46, '87.79', '105.04', '113.67']
[14, '2024-10-27', 30, '98.46', '113.67', '120.33']
[15, '2024-10-28', 39, '105.53', '120.33', '114.69']
[16, '2024-10-29', 26, '107.34', '114.69', '135.76']
[17, '2024-10-30', 43, '127.44', '135.76', '137.08']
[18, '2024-10-31', 39, '129.14', '137.08', '143.85']
[19, '2024-11-01', 28, '141.94', '143.85', '127.53']
[20, '2024-11-02', 41, '101.88', '127.53', '123.89']
[21, '2024-11-03', 22, '96.50', '123.89', '132.95']
[22, '2024-11-04', 12, '44.97', '132.95', '137.24']
[23, '2024-11-05', 43, '106.32', '137.24', '140.51']
[24, '2024-11-06', 19, '70.47', '140.51', '153.43']
[25, '2024-11-07', 44, '113.95', '153.43', '182.61']
[26, '2024-11-08', 19, '105.57', '182.61', '211.74']
[27, '2024-11-09', 42, '169.92', '211.74', '238.58']
[28, '2024-11-10', 23, '153.48', '238.58', '188.80']
[29, '2024-11-11', 22, '156.03', '188.80', '223.47']
Updated Ledger (daily_ledger_scaled_weight4):
[1, '2024-10-11', 24, '65.15', '100.00', '90.36']
[2, '2024-10-15', 45, '76.20', '90.36', '89.96']
[3, '2024-10-16', 22, '75.71', '89.96', '81.03']
[4, '2024-10-17', 45, '66.30', '81.03', '83.91']
[5, '2024-10-18', 24, '75.03', '83.91', '69.38']
[6, '2024-10-19', 45, '51.69', '69.38', '66.83']
[7, '2024-10-20', 5, '10.79', '66.83', '76.41']
[8, '2024-10-21', 7, '17.71', '76.41', '82.24']
[9, '2024-10-22', 39, '48.56', '82.24', '77.40']
[10, '2024-10-23', 6, '14.84', '77.40', '74.57']
[11, '2024-10-24', 37, '67.13', '74.57', '87.20']
[12, '2024-10-25', 18, '41.94', '87.20', '103.86']
[13, '2024-10-26', 45, '85.29', '103.86', '114.54']
[14, '2024-10-27', 29, '100.07', '114.54', '120.01']
[15, '2024-10-28', 39, '105.47', '120.01', '158.36']
[16, '2024-10-29', 26, '153.62', '158.36', '187.34']
[17, '2024-10-30', 45, '179.64', '187.34', '187.38']
[18, '2024-10-31', 39, '176.51', '187.38', '196.00']
[19, '2024-11-01', 40, '189.12', '196.00', '178.00']
[20, '2024-11-02', 42, '142.14', '178.00', '167.39']
[21, '2024-11-03', 24, '141.43', '167.39', '198.95']
[22, '2024-11-04', 12, '68.63', '198.95', '205.42']
[23, '2024-11-05', 44, '159.41', '205.42', '208.79']
[24, '2024-11-06', 19, '110.52', '208.79', '226.45']
[25, '2024-11-07', 45, '165.65', '226.45', '271.98']
[26, '2024-11-08', 21, '166.48', '271.98', '316.93']
[27, '2024-11-09', 44, '255.90', '316.93', '356.13']
[28, '2024-11-10', 23, '235.68', '356.13', '285.00']
[29, '2024-11-11', 23, '243.84', '285.00', '336.17']
