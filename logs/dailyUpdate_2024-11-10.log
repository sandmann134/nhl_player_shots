/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Processing Minnesota Wild at Chicago Blackhawks, ID: d1e707ee60f15f916dd76d6bb52866e1
Processing San Jose Sharks at New Jersey Devils, ID: 95fc029b865d3cafe47a8cc305b786ed
Processing Columbus Blue Jackets at Anaheim Ducks, ID: c047bb93eb8b8918fdfa06a485471ae5
Processing Montr√©al Canadiens at Buffalo Sabres, ID: d7125bb54ce757ff72ac14083340dc29
Processing Dallas Stars at Pittsburgh Penguins, ID: 6cde37b5e7abed2600ee06a73f3b63a7
Processing San Jose Sharks at Philadelphia Flyers, ID: e0007c71c4be49543066be6a73846b69
Processing Los Angeles Kings at Calgary Flames, ID: a6abee067a4789162efa7a9273e68395
Processing Nashville Predators at Colorado Avalanche, ID: 246eebe132c8b973e33d4a4466903240
Processing Carolina Hurricanes at Vegas Golden Knights, ID: 82fe7beff9eb582f856f4ae514dcc916
Used requests: 71
Remaining requests: 429
/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Fetching and storing player data with weights: x_10 = 5, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled, model table: modelled_likelihoods
Found 108 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8481716 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/weight_test.py:4: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd # type: ignore
/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Python interpreter: /Library/Developer/CommandLineTools/usr/bin/python3
Created table daily_ledger_scaled_weight3
Created table modelled_likelihoods_weight3
Fetching and storing player data with weights: x_10 = 3, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight3, model table: modelled_likelihoods_weight3
Found 108 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8481716 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
WARNING: Sum of suggested bets for date 2024-11-09 is greater than bankroll.
WARNING: Scaling all suggested bets for date 2024-11-09 by 0.47 to reduce bet volume below 100%.
Entire daily_ledger_scaled_weight3 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_weight3:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Created table daily_ledger_scaled_weight4
Created table modelled_likelihoods_weight4
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4, model table: modelled_likelihoods_weight4
Found 108 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
Traceback (most recent call last):
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/connectionpool.py", line 466, in _make_request
    self._validate_conn(conn)
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/connectionpool.py", line 1095, in _validate_conn
    conn.connect()
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/connection.py", line 730, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/connection.py", line 909, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/util/ssl_.py", line 469, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/util/ssl_.py", line 513, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/ssl.py", line 500, in wrap_socket
    return self.sslsocket_class._create(
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/ssl.py", line 1040, in _create
    self.do_handshake()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/ssl.py", line 1309, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:1129)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/connectionpool.py", line 789, in urlopen
    response = self._make_request(
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/connectionpool.py", line 490, in _make_request
    raise new_e
urllib3.exceptions.SSLError: EOF occurred in violation of protocol (_ssl.c:1129)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/connectionpool.py", line 843, in urlopen
    retries = retries.increment(
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api-web.nhle.com', port=443): Max retries exceeded with url: /v1/standings/now (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/weight_test.py", line 115, in <module>
    main()
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/weight_test.py", line 73, in main
    fetch_and_store_player_data(i, 3, 2, 1)
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/player_api.py", line 274, in fetch_and_store_player_data
    player_info = get_player_id(home_team, away_team, player_name)
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/player_api.py", line 54, in get_player_id
    team1_id = get_NHL_abbreviations(team1)
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/player_api.py", line 170, in get_NHL_abbreviations
    response = requests.get(f"{base_url}/standings/now")
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/requests/adapters.py", line 698, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api-web.nhle.com', port=443): Max retries exceeded with url: /v1/standings/now (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/opposition_test.py:4: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd # type: ignore
/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Python interpreter: /Library/Developer/CommandLineTools/usr/bin/python3
Created table daily_ledger_scaled_weight4_tenthOppositionFactor
Created table modelled_likelihoods_weight4_tenthOppositionFactor
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4_wQuarterOppositionFactor, model table: modelled_likelihoods_weight4_wQuarterOppositionFactor
Found 108 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8481716 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4_wHalfOppositionFactor, model table: modelled_likelihoods_weight4_wHalfOppositionFactor
Found 108 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8481716 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4_wOppositionFactor, model table: modelled_likelihoods_weight4_wOppositionFactor
Found 108 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8481716 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4_tenthOppositionFactor, model table: modelled_likelihoods_weight4_tenthOppositionFactor
Found 108 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
Traceback (most recent call last):
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/connectionpool.py", line 466, in _make_request
    self._validate_conn(conn)
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/connectionpool.py", line 1095, in _validate_conn
    conn.connect()
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/connection.py", line 730, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/connection.py", line 909, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/util/ssl_.py", line 469, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/util/ssl_.py", line 513, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/ssl.py", line 500, in wrap_socket
    return self.sslsocket_class._create(
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/ssl.py", line 1040, in _create
    self.do_handshake()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/ssl.py", line 1309, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:1129)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/connectionpool.py", line 789, in urlopen
    response = self._make_request(
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/connectionpool.py", line 490, in _make_request
    raise new_e
urllib3.exceptions.SSLError: EOF occurred in violation of protocol (_ssl.c:1129)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/connectionpool.py", line 843, in urlopen
    retries = retries.increment(
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api-web.nhle.com', port=443): Max retries exceeded with url: /v1/player/8473994/game-log/20222023/2 (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/opposition_test.py", line 123, in <module>
    main()
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/opposition_test.py", line 70, in main
    fetch_and_store_player_data(4, 3, 2, 1, 0.1)
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/player_api.py", line 287, in fetch_and_store_player_data
    twothree_season_shots = get_shots_per_game(player_id, '20222023', date)
  File "/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/player_api.py", line 35, in get_shots_per_game
    response = requests.get(season_url)
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/Users/alexmann/Library/Python/3.9/lib/python/site-packages/requests/adapters.py", line 698, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api-web.nhle.com', port=443): Max retries exceeded with url: /v1/player/8473994/game-log/20222023/2 (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
/Users/alexmann/Documents/Code_Learning/nhl_fromscratch/weight_test3_avg.py:4: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd # type: ignore
/Users/alexmann/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
Python interpreter: /Library/Developer/CommandLineTools/usr/bin/python3
Created table daily_ledger_scaled_2324flat
Created table modelled_likelihoods_2324flat
Created table daily_ledger_scaled_2324flat_x10_3
Created table modelled_likelihoods_2324flat_x10_3
Created table daily_ledger_scaled_222324flat_x10_3
Created table modelled_likelihoods_222324flat_x10_3
Fetching and storing player data with weights: x_10 = 1, x_2024 = 1, x_2023 = 1, x_2022 = 0
Using ledger: daily_ledger_scaled_2324flat, model table: modelled_likelihoods_2324flat
Found 108 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8481716 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
Fetching and storing player data with weights: x_10 = 3, x_2024 = 1, x_2023 = 1, x_2022 = 0
Using ledger: daily_ledger_scaled_2324flat_x10_3, model table: modelled_likelihoods_2324flat_x10_3
Found 108 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8481716 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
Fetching and storing player data with weights: x_10 = 3, x_2024 = 1, x_2023 = 1, x_2022 = 1
Using ledger: daily_ledger_scaled_222324flat_x10_3, model table: modelled_likelihoods_222324flat_x10_3
Found 108 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8481716 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
Fetching and storing player data with weights: x_10 = 4, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled_weight4, model table: modelled_likelihoods_weight4
Found 108 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484166 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484166 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8481716 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8481716 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
WARNING: Sum of suggested bets for date 2024-11-09 is greater than bankroll.
WARNING: Scaling all suggested bets for date 2024-11-09 by 0.59 to reduce bet volume below 100%.
WARNING: Sum of suggested bets for date 2024-11-09 is greater than bankroll.
WARNING: Only using 2024-11-09 suggested bets > 2% of bankroll to reduce bet volume below 100%.
WARNING: Sum of suggested bets for date 2024-11-09 is greater than bankroll.
WARNING: Scaling all suggested bets for date 2024-11-09 by 0.41 to reduce bet volume below 100%.
WARNING: Sum of suggested bets for date 2024-11-09 is greater than bankroll.
WARNING: Scaling all suggested bets for date 2024-11-09 by 0.51 to reduce bet volume below 100%.
Entire daily_ledger_scaled_2324flat table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_2324flat:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Entire daily_ledger_scaled_2324flat_x10_3 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_2324flat_x10_3:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Entire daily_ledger_scaled_222324flat_x10_3 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_222324flat_x10_3:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Entire daily_ledger_scaled_weight3 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_weight3:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Entire daily_ledger_scaled_weight4 table:
Empty DataFrame
Columns: [id, date, number_of_bets_suggested, dollar_value_of_bets_suggested, initial_dollar_value, final_dollar_value]
Index: []
Daily dollar amounts for daily_ledger_scaled_weight4:
Empty DataFrame
Columns: [final_dollar_value]
Index: []
Python interpreter: /Users/alexmann/.pyenv/versions/3.9.16/bin/python3
Fetching and storing player data with weights: x_10 = 5, x_2024 = 3, x_2023 = 2, x_2022 = 1
Using ledger: daily_ledger_scaled, model table: modelled_likelihoods
Found 32 players to model.
Matt Coronato has less than 60 GP.
Matt Coronato has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8482702 before date 2024-11-09 for season 20222023.
Logan Stankoven has less than 60 GP.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484144 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20232024.
No valid game log data available for player ID: 8484801 before date 2024-11-10 for season 20222023.
Macklin Celebrini has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8483445 before date 2024-11-10 for season 20222023.
Cutter Gauthier has less than 60 GP.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8484153 before date 2024-11-10 for season 20222023.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
No valid game log data available for player ID: 8482803 before date 2024-11-10 for season 20222023.
Olen Zellweger has less than 60 GP.
CSV file modelled_likelihoods_2024-11-10.csv created at /Users/alexmann/Documents/Code_Learning/nhl_fromscratch/daily_odds/modelled_likelihoods_2024-11-10.csv.
WARNING: Sum of suggested bets for date 2024-11-09 is greater than bankroll.
WARNING: Scaling all suggested bets for date 2024-11-09 by 0.53 to reduce bet volume below 100%.
Updated Ledger (daily_ledger_scaled):
[1, '2024-10-11', 27, '91.06', '100.00', '89.48']
[2, '2024-10-15', 46, '75.72', '89.48', '89.68']
[3, '2024-10-16', 24, '88.09', '89.68', '77.24']
[4, '2024-10-17', 45, '62.52', '77.24', '80.25']
[5, '2024-10-18', 27, '79.52', '80.25', '64.91']
[6, '2024-10-19', 43, '45.81', '64.91', '64.25']
[7, '2024-10-20', 5, '13.11', '64.25', '75.91']
[8, '2024-10-21', 7, '22.30', '75.91', '84.02']
[9, '2024-10-22', 39, '48.96', '84.02', '78.99']
[10, '2024-10-23', 7, '20.05', '78.99', '76.37']
[11, '2024-10-24', 36, '68.50', '76.37', '88.73']
[12, '2024-10-25', 18, '40.38', '88.73', '105.04']
[13, '2024-10-26', 46, '87.79', '105.04', '113.67']
[14, '2024-10-27', 30, '98.46', '113.67', '120.33']
[15, '2024-10-28', 39, '105.53', '120.33', '114.69']
[16, '2024-10-29', 26, '107.34', '114.69', '135.76']
[17, '2024-10-30', 43, '127.44', '135.76', '137.08']
[18, '2024-10-31', 39, '129.14', '137.08', '143.85']
[19, '2024-11-01', 28, '141.94', '143.85', '127.53']
[20, '2024-11-02', 41, '101.88', '127.53', '123.89']
[21, '2024-11-03', 22, '96.50', '123.89', '132.95']
[22, '2024-11-04', 12, '44.97', '132.95', '137.24']
[23, '2024-11-05', 43, '106.32', '137.24', '140.51']
[24, '2024-11-06', 19, '70.47', '140.51', '153.43']
[25, '2024-11-07', 44, '113.95', '153.43', '182.61']
[26, '2024-11-08', 19, '105.57', '182.61', '211.74']
[27, '2024-11-09', 42, '169.92', '211.74', '238.58']
Updated Ledger (daily_ledger_scaled_weight4):
[1, '2024-10-11', 24, '65.15', '100.00', '90.36']
[2, '2024-10-15', 45, '76.20', '90.36', '89.96']
[3, '2024-10-16', 22, '75.71', '89.96', '81.03']
[4, '2024-10-17', 45, '66.30', '81.03', '83.91']
[5, '2024-10-18', 24, '75.03', '83.91', '69.38']
[6, '2024-10-19', 45, '51.69', '69.38', '66.83']
[7, '2024-10-20', 5, '10.79', '66.83', '76.41']
[8, '2024-10-21', 7, '17.71', '76.41', '82.24']
[9, '2024-10-22', 39, '48.56', '82.24', '77.40']
[10, '2024-10-23', 6, '14.84', '77.40', '74.57']
[11, '2024-10-24', 37, '67.13', '74.57', '87.20']
[12, '2024-10-25', 18, '41.94', '87.20', '103.86']
[13, '2024-10-26', 45, '85.29', '103.86', '114.54']
[14, '2024-10-27', 29, '100.07', '114.54', '120.01']
[15, '2024-10-28', 39, '105.47', '120.01', '158.36']
[16, '2024-10-29', 26, '153.62', '158.36', '187.34']
[17, '2024-10-30', 45, '179.64', '187.34', '187.38']
[18, '2024-10-31', 39, '176.51', '187.38', '196.00']
[19, '2024-11-01', 40, '189.12', '196.00', '178.00']
[20, '2024-11-02', 42, '142.14', '178.00', '167.39']
[21, '2024-11-03', 24, '141.43', '167.39', '198.95']
[22, '2024-11-04', 12, '68.63', '198.95', '205.42']
[23, '2024-11-05', 44, '159.41', '205.42', '208.79']
[24, '2024-11-06', 19, '110.52', '208.79', '226.45']
[25, '2024-11-07', 45, '165.65', '226.45', '271.98']
[26, '2024-11-08', 21, '166.48', '271.98', '316.93']
[27, '2024-11-09', 44, '255.90', '316.93', '356.13']
